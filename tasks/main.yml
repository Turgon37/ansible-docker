---
- name: Include the OS specific variables
  include_vars: "{{ item }}"
  with_first_found:
    - files:
        - "{{ ansible_distribution }}.yml"
        - "{{ ansible_os_family }}.yml"
      skip: true
  tags: ['docker']

- name: Add Docker repo for Yum based hosts
  copy:
    src: docker.repo
    dest: '/etc/yum.repos.d/docker.repo'
  when: ansible_os_family == 'RedHat'
  tags: ['docker']

- name: Install the latest version of docker engine
  package:
    name: '{{ item }}'
    state: latest
  with_items:
    - '{{ docker__packages_name }}'
  tags: ['docker']

- name: Ensure docker daemon is started and enabled on boot
  become: yes
  service:
    name: "{{ docker__service_name }}"
    state: started
    enabled: yes
  changed_when: False
  tags: ['docker']
