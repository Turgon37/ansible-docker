---

- name: Remove conflicting packages
  package:
    name:  '{{ item }}'
    state: absent
  with_items: '{{ docker_server__conflict_packages }}'

- include_tasks: "install-{{ item }}.yml"
  with_first_found:
    - files:
        - "{{ ansible_distribution }}-{{ ansible_distribution_version }}.yml"
        - "{{ ansible_distribution }}.yml"
        - "{{ ansible_os_family }}.yml"
      skip: true

- name: Install docker engine
  package:
    name:  '{{ docker_server__packages_name }}'
    state: present

- include_tasks: install-compose.yml
